# [Food for all](http://food-for-all.tk)

Выпускной проект программы Яндекс.Практикум [Python-разработчик](https://praktikum.yandex.ru/backend-developer/ "Ccылка на курс")

[Food for all](http://food-for-all.tk) - это сайт, на котором пользователи могут публиковать рецепты, добавлять чужие рецепты в избранное и подписываться на публикации других авторов. Сервис «Список покупок» позволяет пользователям создавать список продуктов, которые нужно купить для приготовления выбранных блюд.

## Начало работы

Запустить проект можно в контейнерах Docker. Для этого подготовлены конфигурационные файлы Dockerfile и docker-compose.yaml.  

### Подготовка к запуску

Для запуска приложения необходимо установить на компьютер Docker и утилиту docker-compose. Информация по установке доступна на официальном сайте документации, по ссылкам:
 - `https://docs.docker.com/get-docker/` 
 - `https://docs.docker.com/compose/install/`

Проект запускается в трех контейнерах. Первый - контейнер с базой данных PostgreSQL, второй - контейнер с Web-приложением, третий - контейнер с NGINX. Настройки базы данных экспортируются из переменных окружения, указанных в проекте. Чтобы задать свои значения нужно в корневой директории создать файл .env следующего содержания: 

```
# имя базы данных
DB_NAME=postgres

# логин для подключения к базе данных
POSTGRES_USER=postgres 

# пароль для подключения к БД (установите свой)
POSTGRES_PASSWORD=postgres

# название сервиса (контейнера)
DB_HOST=db

# порт для подключения к БД
DB_PORT=5432
```

#### Настройка доступности сервера

Для получения доступа к сайту, необходимо:

1) в папке nginx, файл default.conf, в строке server_name добавьте ip сервера и доменное имя для сайта.

2) в папке foodgram, в файле settings.py в ALLOWED_HOSTS добавьте ip адрес сервера и доменное имя для сайта.

#### Запуск приложения

Для запуска приложения в терминале нужно перейти в корневую директорию проекта и выполнить команду:
 
 ```docker-compose up``` 

#### Первый запуск

Первый запуск приложения отличается от последующих запусков. Если вы запускаете приложение впервые вам нужно создать в базе данных структуру проекта(создать таблицы и связи между ними), собрать статические файлы в одну директорию и создать администратора приложения.

После выполнения команды ```docker-compose up``` в операционной системе запустятся два контейнера. С помощью команды ```docker ps -a``` нужно найти ID контейнера с именем ```foodgram_web```. 

Далее, с помощью команды ```sudo docker exec -it <container_ID> bash``` необходимо запустить терминал внутри контейнера с Web-приложением.

Создать необходимую структуру базы данных с помощью комманды:

```python manage.py migrate```

Выполнить сбор статичных файлов в одну директорию:

```python manage.py collectstatic```

Создать администратора приложения, следую инструкциям команды:

```python manage.py createsuperuser```

#### Загрузка подготовленных ингредиентов для рецептов

Предусмотренна вомзожность импортировать в базу данных подготовленные ингредиенты. Загрузить тингредиенты в базу можно из терминала контейнера Web-приложения, командой: 

```python manage.py load_ingredients_data```

Вы всегда можете отказаться от импортирования ингредиентов и добавить их вручную на странице администратирования.
